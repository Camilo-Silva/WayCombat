<!-- GALERÍA - Grid de fotos con filtros -->
<div class="container-fluid py-5 bg-light">
  <!-- Hero Section -->
  <div class="container">
    <div class="row text-center mb-5">
      <div class="col-12">
        <h1 class="display-4 fw-bold text-primary-blue mb-3">
          <i class="fas fa-images me-3"></i>Galería Way Combat
        </h1>
        <p class="lead text-muted mb-4">
          Revive los mejores momentos de nuestros entrenamientos, jornadas y eventos
        </p>
        <div class="d-flex justify-content-center gap-3 flex-wrap">
          <button 
            class="btn btn-way-primary btn-lg"
            [class.active]="selectedFilter === 'todos'"
            (click)="filterGallery('todos')">
            <i class="fas fa-th me-2"></i>Todos
          </button>
          <button 
            class="btn btn-outline-primary btn-lg"
            [class.active]="selectedFilter === 'entrenamientos'"
            (click)="filterGallery('entrenamientos')">
            <i class="fas fa-dumbbell me-2"></i>Entrenamientos
          </button>
          <button 
            class="btn btn-outline-primary btn-lg"
            [class.active]="selectedFilter === 'jornada-waycombat'"
            (click)="filterGallery('jornada-waycombat')">
            <i class="fas fa-calendar-check me-2"></i>Jornada WayCombat
          </button>
          <button 
            class="btn btn-outline-primary btn-lg"
            [class.active]="selectedFilter === 'eventos'"
            (click)="filterGallery('eventos')">
            <i class="fas fa-calendar-alt me-2"></i>Eventos
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Galería Grid -->
<div class="container py-5">
  <div class="row" *ngIf="!isLoading && filteredItems.length > 0">
    <div 
      class="col-lg-4 col-md-4 col-sm-6 mb-4" 
      *ngFor="let item of filteredItems; let i = index">
      <div class="gallery-item position-relative">
        
        <!-- Imagen -->
        <div class="image-container position-relative overflow-hidden rounded">
          <img 
            [src]="item.thumbnail || item.url || 'assets/images/default-gallery.jpg'"
            [alt]="item.titulo"
            class="w-100 gallery-image"
            (click)="openModal(item)"
            style="height: 250px; object-fit: cover; cursor: pointer;">
          
          <!-- Overlay con icono de play para videos -->
          <div 
            class="image-overlay position-absolute top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center"
            *ngIf="item.tipo === 'video'"
            (click)="openModal(item)">
            <div class="play-button bg-white bg-opacity-75 rounded-circle p-3">
              <i class="fas fa-play text-primary fa-2x"></i>
            </div>
          </div>
          
          <!-- Badge del tipo de contenido -->
          <div class="position-absolute top-0 end-0 m-2">
            <span class="badge bg-dark bg-opacity-75">
              <i [class.fas]="true" [class.fa-image]="item.tipo === 'imagen'" [class.fa-video]="item.tipo === 'video'" class="me-1"></i>
              {{ item.tipo === 'imagen' ? 'Foto' : 'Video' }}
            </span>
          </div>
        </div>

        <!-- Etiqueta de categoría -->
        <div class="text-center mt-3">
          <span 
            class="badge fs-6 px-3 py-2"
            [ngClass]="getCategoryBadgeClass(item.categoria)">
            {{ getCategoryLabel(item.categoria) }}
          </span>
        </div>

      </div>
    </div>
  </div>

  <!-- Estado de carga -->
  <div class="row" *ngIf="isLoading">
    <div class="col-12 text-center py-5">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Cargando...</span>
      </div>
      <p class="mt-3 text-muted">Cargando galería...</p>
    </div>
  </div>

  <!-- Sin resultados -->
  <div class="row" *ngIf="!isLoading && filteredItems.length === 0">
    <div class="col-12 text-center py-5">
      <div class="mb-4">
        <i class="fas fa-images fa-4x text-muted mb-3"></i>
        <h3 class="text-muted">No hay contenido disponible</h3>
        <p class="text-muted">
          No se encontraron elementos para el filtro seleccionado.
        </p>
      </div>
      <button class="btn btn-way-primary" (click)="filterGallery('todos')">
        <i class="fas fa-refresh me-2"></i>Mostrar Todo
      </button>
    </div>
  </div>
</div>

<!-- Modal para ver imagen/video -->
<div class="modal fade" id="galleryModal" tabindex="-1" *ngIf="selectedItem">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">{{ selectedItem.titulo }}</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body text-center">
        
        <!-- Imagen -->
        <div *ngIf="selectedItem.tipo === 'imagen'" class="mb-3">
          <img 
            [src]="selectedItem.url"
            [alt]="selectedItem.titulo"
            class="img-fluid rounded"
            style="max-height: 500px;">
        </div>

        <!-- Video -->
        <div *ngIf="selectedItem.tipo === 'video'" class="mb-3">
          <video 
            controls 
            class="w-100" 
            [src]="selectedItem.url"
            style="max-height: 500px;">
            Tu navegador no soporta el elemento de video.
          </video>
        </div>

        <!-- Descripción -->
        <div class="mt-3">
          <p class="text-muted">{{ selectedItem.descripcion }}</p>
          <div class="d-flex justify-content-between align-items-center">
            <span 
              class="badge"
              [ngClass]="getCategoryBadgeClass(selectedItem.categoria)">
              {{ getCategoryLabel(selectedItem.categoria) }}
            </span>
            <small class="text-muted" *ngIf="selectedItem.fecha">
              {{ selectedItem.fecha | date:'dd/MM/yyyy' }}
            </small>
          </div>
        </div>

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
        <button 
          type="button" 
          class="btn btn-primary"
          *ngIf="selectedItem.descargable"
          (click)="downloadItem(selectedItem)">
          <i class="fas fa-download me-2"></i>Descargar
        </button>
      </div>
    </div>
  </div>
</div>
